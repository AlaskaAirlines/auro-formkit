import * as stories from "./datepicker.stories";
import description from "../docs/partials/description.md?raw"
import api from "../docs/api.md?raw";
import tokens from "../src/styles/tokens.scss?raw";

<Meta of={stories} />

# Datepicker

<Markdown>{description}</Markdown>

<Markdown>{api}</Markdown>

## API Examples

### Basic

<Canvas of={stories.Basic} />

#### Basic Range

When used, the datepicker will display two inputs and the component will support selection of dates for a start and end date.

<Canvas of={stories.BasicRange} />

### Attribute Examples

#### disabled

If set, disables the datepicker.

<Canvas of={stories.Disabled} />

#### error

Use the `error` attribute to apply a persistent custom error that supersedes the HTML5 validation logic.

A custom error message can be set using the `error` attribute, or it can be used in conjuction with the `setCustomValidityCustomError` attribute.

<Canvas of={stories.Error} />

#### calendarStartDate & calendarEndDate

The `calendarStartDate` and `calendarEndDate` properties may be used to explicitly control which calendar months _may_ be rendered in the calendar.

In <strong>desktop</strong>, the calendar month navigation will be restricted by these dates. In <strong>mobile</strong>, the following logic is used:

- if both `calendarStartDate` and `calendarEndDate` are defined: all months between, including these dates, will be rendered.
- If only `calendarStartDate` is defined: 12 months will be rendered starting with this value.
- if only `calendarEndDate` is defined: The current date month through the value of this attribute will be rendered.

Note: This does not restrict setting a value outside of those date constraints. These properties _only_ define which months can be rendered in the calendar. A user may still type any date into the input field. If actual value selection restrictions are needed, see the `minDate` and `maxDate` properties which may be used standalone, or in conjunction with `calendarStartDate` and `calendarEndDate`.

<Canvas of={stories.CalendarStartAndEndDate} />

#### calendarFocusDate

The `calendarFocusDate` controls which calendar month is first presented to the user when they open the dropdown bib.

In <strong>desktop</strong> layout, the first month actually rendered will be the `calendarFocusDate` if defined. Once the user manually navigates the calendar to a different month, the calendar view will remain where the user left off when they close and reopen the bib. If the `calendarFocusDate` attribute is changed, this will re-render the calendar starting at the new date. If `calendarFocusDate` is undefined, the first rendered month will be the current date or the first renderable date defined by `calendarStartDate`.

In <strong>mobile</strong> layout, upon first opening the bib, the vertical list of months will scroll (with no animation) to the month defined by the `calendarFocusDate`. If the user scrolls the list to a different position, the scroll position will remain where the user left off when they close and reopen the bib. If the `calendarFocusDate` is changed, the list will scroll to the new dates month. If `calendarFocusDate` is undefined, the list will start at the top most scroll position.

<Canvas of={stories.CalendarFocusDate} />

#### maxDate

To give a higher limit you can bind a date to the `maxDate` attribute. It is recommended to use the `setCustomValidityRangeOverflow` attribute to define an error message to display when validation fails the maximum date restriction.

<Canvas of={stories.MaxDate} />

Setting the `maxDate` attribute to a date earlier than the auro-datepicker `value` will result in the following changes to the component state:

- `value` will to reset to `undefined`.
- If the currently viewed calendar month is later than the new `maxDate`, the calendar view will move to the new `maxDate` month.

This example demonstrates that behavior.

<Canvas of={stories.UpdateMaxDate} />

#### minDate

To give a lower limit you can bind a date to the `minDate` attribute. It is recommended to use the `setCustomValidityRangeUnderflow` attribute to define an error message to display when validation fails the minimum date restriction.

<Canvas of={stories.MinDate} />

Setting the `minDate` attribute to a date later than the auro-datepicker `value` will result in the following changes to the component state:

- `value` will to reset to `undefined`.
- If the currently viewed calendar month is earlier than the new `minDate`, the calendar view will move to the new `minDate` month.

This example demonstrates that behavior.

<Canvas of={stories.UpdateMinDate} />

#### noValidate

When set, the datepicker will not validate when navigating away from the component.

<Canvas of={stories.NoValidate} />

#### required

Populates the `required` attribute on the input. Used for client-side validation.

When the validity check fails the validityState, equals `valueMissing`. The error message for the `valueMissing` validityState can be set to a custom string using the `setCustomValidityValueMissing`. There is no default error message defined.

<Canvas of={stories.Required} />

#### validity

Specifies the `validityState` the element is in. Upon first interaction, or presetting the `error` attribute, the component will validate on `focusout`. After validation, `validityState` can be queried from the component by using the following JavaScript.

<Canvas of={stories.Validity} />

#### value

Value selected for the datepicker. Can be used to pre-set the value of the datepicker. When the `range` attribute is used, `value` is for the first input.

<Canvas of={stories.Value} />

#### valueEnd

Value of the second input (end date), selected for the datepicker. Can be used to pre-set the value of the datepicker. Only applicable for a datepicker with the `range` attribute.

<Canvas of={stories.ValueEnd} />

#### format

The `format` attribute is used to define the date format used by the datepicker. The default value is `mm/dd/yyyy`.

<Canvas of={stories.Format} />

### Method Examples

#### focus

The focus method will apply focus state to the datepicker's input field.

<Canvas of={stories.Focus} />

### Slot Examples

#### fromLabel

Sets the label used for the input. When the `range` attribute is used this is the first of two inputs.

<Canvas of={stories.Basic} />

#### helpText

Sets the help text displayed below the trigger. The `helpText` slot can be used to provide additional context for the combobox. When using the `error` attribute, the `helpText` slot can be used to describe the error.

<Canvas of={stories.HelpText} />

#### bib.fullscreen.dateLabel and bib.fullscreen.headline

Sets the headline and the label at the top of the bib when viewed in the mobile layout.
To view this demo, set your window to a mobile screen size.

<Canvas of={stories.Basic} />

#### toLabel

Only for use with the `range` attribute. Sets the label for the second input.

<Canvas of={stories.BasicRange} />

#### Date Slot

Custom content can be added to any day in the calendar using a `slot` named following the pattern `date_{MM}_{DD}_{YYYY}` (e.g. `date_01_08_2024`).

Adding the `highlight` attribute to the slot will change the slot content's color to `var(--ds-color-text-success-default)`.

Slot content support is limited to text only and a maximum of five (5) characters.

Slot content can be styled using [inline styles](https://www.codecademy.com/article/html-inline-styles) or [CSS Parts](https://css-tricks.com/styling-in-the-shadow-dom-with-css-shadow-parts/) (`part="dateSlot"`).

<Canvas of={stories.DateSlot} />

#### Popover Slot

Custom content can be added to any day's `auro-popover` in the calendar using a `slot` named following the pattern `popover_{MM}_{DD}_{YYYY}` (e.g. `popover_01_08_2024`).

The popover slot is intended for use with calendar dates that are `disabled` (e.g. before minimum date or after maximum date).

<Canvas of={stories.PopoverSlot} />

### Functional Examples

#### Localization

The datepicker supports localized month names through the `monthNames` property.

This example demonstrates how to set the `monthNames` property to Korean month names, with a Korean date format.

<Canvas of={stories.Localization} />

#### Reset State

Use the `reset()` method to reset the `<auro-datepicker>`'s `value`, `valueEnd` and `validity` state. Doing so will preserve all other attributes and properties.

{/*  */}

<Canvas of={stories.ResetState} />

#### Dynamic Slot Content

This example demonstrates data driven slot content for days in the calendar. In this example, the slot content is inserted into each `auro-calendar-cell` after the bib of the `auro-datepicker` is opened, simulating an API call on a dynamic data source.

<Canvas of={stories.DynamicSlot} />

### Watch for value changes

The following example listens for the `auroDatePicker-valueSet` event. Once triggered, `element.value` may be queried for the new value **and** in successful scenarios, an alert will appear. Open the JavaScript console in the browser's developer tools to see the `console.warn` message that appears after the `auroDatePicker-valueSet` event has been triggered.

<Canvas of={stories.LogValue} />

#### in Dialog

The component can be in a dialog.

<Canvas of={stories.InDialog} />

### Theme Support

The component may be restyled using the following code sample and changing the values of the following token(s).

<Markdown>
{`
  \`\`\`scss
  ${tokens}
  \`\`\`
`}
</Markdown>
